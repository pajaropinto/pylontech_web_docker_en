<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pylontech Monitor</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/4.3.2/mqtt.min.js"></script>
</head>

<body>
    <div class="container">
        <h1>ğŸ”‹ Pylontech Monitor</h1>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="openTab(event, 'tab1')">ğŸ“Š Totals</button>
            <button class="tab-button" onclick="openTab(event, 'tab2')">ğŸ”‹ Batteries</button>
            <button class="tab-button" onclick="openTab(event, 'tab3')">âš™ï¸ Configuration</button>
        </div>

        <!-- Tab 1: Totals -->
        <div id="tab1" class="tab-content" style="display: block;">
            <h2>ğŸ“Š System Totals</h2>
            <div id="mqttStatus" class="status-indicator"></div>

            <table id="systemTable" class="data-table">
                <thead>
                    <tr>
                        <th>Voltage (V)</th>
                        <th>Current (A)</th>
                        <th>Temperature (Â°C)</th>
                        <th>SOC (%)</th>
                        <th>Status</th>
                        <th>Coulomb (Ah)</th>
                        <th>Cycles</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="sys_voltage">-</td>
                        <td id="sys_current">-</td>
                        <td id="sys_temp">-</td>
                        <td id="sys_soc">-</td>
                        <td id="sys_status">-</td>
                        <td id="sys_coulomb">-</td>
                        <td id="sys_cycle">-</td>
                    </tr>
                </tbody>
            </table>

            <h2>ğŸ”‹ Battery Totals</h2>
            <table id="batteryTable" class="data-table">
                <thead>
                    <tr>
                        <th>Battery</th>
                        <th>Voltage (V)</th>
                        <th>Current (A)</th>
                        <th>Temperature (Â°C)</th>
                        <th>SOC (%)</th>
                        <th>Status</th>
                        <th>Coulomb (Ah)</th>
                        <th>Cycles</th>
                    </tr>
                </thead>
                <tbody id="batteryTableBody">
                </tbody>
            </table>
        </div>

        <!-- Tab 2: Batteries -->
        <div id="tab2" class="tab-content" style="display: none;">
            <h2>ğŸ”‹ Battery Data</h2>
            <div id="batteriesContainer">
                <p>Loading battery data...</p>
            </div>
        </div>

        <!-- Tab 3: Configuration -->
        <div id="tab3" class="tab-content" style="display: none;">
            <h2>âš™ï¸ System Configuration</h2>

            <div class="config-section">
                <div class="config-group">
                    <label for="num_batteries">Number of batteries:</label>
                    <input type="number" id="num_batteries" min="1" max="16">
                </div>

                <div class="config-group">
                    <label for="delay_between_batteries">Delay between batteries (ms):</label>
                    <input type="number" id="delay_between_batteries" min="100">
                </div>

                <div class="config-group">
                    <label for="delay_between_cycle_battery">BAT cycle duration (min):</label>
                    <input type="number" id="delay_between_cycle_battery" min="1">
                </div>

                <div class="config-group">
                    <label for="battery_tcp_ip">TCP/Serial interface IP:</label>
                    <input type="text" id="battery_tcp_ip" placeholder="10.0.0.234">
                </div>

                <div class="config-group">
                    <label for="battery_tcp_port">TCP/Serial interface port:</label>
                    <input type="number" id="battery_tcp_port" min="1" max="65535">
                </div>

                <div class="config-group">
                    <label for="mqtt_broker_ip">MQTT Broker IP:</label>
                    <input type="text" id="mqtt_broker_ip" placeholder="10.0.0.250">
                </div>

                <div class="config-group">
                    <label for="mqtt_broker_port">MQTT Port:</label>
                    <input type="number" id="mqtt_broker_port" min="1" max="65535">
                </div>

                <div class="config-group">
                    <label for="mqtt_broker_ws_port">MQTT WebSocket Port:</label>
                    <input type="number" id="mqtt_broker_ws_port" min="1" max="65535">
                </div>

                <div class="config-group">
                    <label for="mqtt_user">MQTT User:</label>
                    <input type="text" id="mqtt_user">
                </div>

                <div class="config-group">
                    <label for="mqtt_password">MQTT Password:</label>
                    <input type="password" id="mqtt_password">
                </div>

                <div class="button-group">
                    <button id="loadConfigBtn">Load</button>
                    <button id="saveConfigBtn">Save</button>
                </div>

                <div id="configStatus"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>
